---

mt_groups_group:
  - name: "{{ api_username }}"
    args:
      - "policy=api,read,write,sensitive,test"
  - name: "prometheus"
    args:
      - "policy=api,read,winbox"

mt_users_group:
  - name: "{{ api_username }}"
    args:
      - "password={{ api_password }}"
      - "group={{ api_username }}"
      - "address={{ mt_admin_allowed_addresses | join(',') }}"
  - name: "prometheus"
    args:
      - "password={{ lookup('community.general.passwordstore', 'network/mt_prom_pass') }}"
      - "group=prometheus"
      - "address={{ subnets.vm.prom | join(',') }}"

mt_groups: "{{ (mt_groups_group | default([])) + (mt_groups_host | default([])) }}"
mt_users: "{{ (mt_users_group | default([])) + (mt_users_host | default([])) }}"
