#!/usr/bin/env -S ansible-playbook
---
- name: Laptop playbook
  gather_facts: true
  diff: yes
  hosts: laptop
  vars:
    node_exporter_skip_install: false
    node_exporter_no_sysusers: true
    node_exporter_version: "latest"
    node_exporter_port: "{{ ports.node_exporter }}"
    node_exporter_collectors: []
  tasks:
    - import_role: { name: common }
      tags: ["all", "common"]

    - name: Merge ports
      set_fact:
        ports: "{{ ports | combine(_ports, recursive=true) }}"
      tags: ["always"]

    - import_role: { name: node_exporter }
      tags: ["prometheus-stack", "node_exporter"]
