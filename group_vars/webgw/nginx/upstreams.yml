---


__nginx_upstreams_common:
  - name: gitlab
    servers: ["{{ hostvars['gitlab01'].ansible_host }}:{{ hostvars['gitlab01'].gitlab_nginx_listen_port }}"]
    keepalive: 16

  - name: registry
    servers: ["{{ hostvars['gitlab01'].ansible_host }}:{{ hostvars['gitlab01'].gitlab_registry_nginx_listen_port }}"]
    keepalive: 16

  - name: grafana
    servers: ["{{ hostvars['prom01'].ansible_host }}:{{ hostvars['prom01'].grafana_port }}"]
    keepalive: 16

  - name: nextcloud
    servers: ["{{ hostvars['nextcloud01'].ansible_host }}:{{ hostvars['nextcloud01'].nextcloud_port }}"]
    keepalive: 16

  - name: plex
    servers: ["{{ hostvars['plex01'].ansible_host }}:{{ hostvars['plex01'].plex_port }}"]
    keepalive: 16

  - name: dv-main
    servers: ["{{ hostvars['theia'].host_ips.vm }}:{{ hostvars['theia'].nginx_ports['www'] }}"]

  - name: mrbot_web
    servers: ["{{ hostvars['dresrv'].ansible_host }}:{{ hostvars['dresrv'].mrbot_web_port }}"]

  - name: jellyfin
    servers: ["{{ hostvars['dresrv'].ansible_host }}:{{ hostvars['dresrv'].jellyfin_port }}"]

  - name: vouch
    servers: ["{{ hostvars['dresrv'].ansible_host }}:{{ hostvars['dresrv'].vouch_listen_port }}"]

  # - name: transmission
  #   servers: ["{{ hostvars['dresrv'].ansible_host }}:{{ hostvars['dresrv'].transmission_port }}"]
  #   keepalive: 16

  # - name: sonarr
  #   servers: ["{{ hostvars['dresrv'].ansible_host }}:{{ hostvars['dresrv'].sonarr_port }}"]
  #   keepalive: 16

  # - name: firefox
  #   servers: ["{{ hostvars['dresrv'].ansible_host }}:{{ hostvars['dresrv'].firefox_port }}"]
  #   keepalive: 16

  # - name: vscode
  #   servers: ["{{ hostvars['dresrv'].ansible_host }}:{{ hostvars['dresrv'].vscode_port }}"]
  #   keepalive: 16

__nginx_upstreams_host:
  - name: nextcloud_ta
    servers: ["{{ hostvars['romsto'].wireguard_ip }}:{{ hostvars['romsto'].nextcloud_port }}"]
    keepalive: 16

nginx_upstreams: "{{ (__nginx_upstreams_common | default([])) + (__nginx_upstreams_host | default([])) }}"
