---

ansible_user: root
ansible_python_interpreter: /usr/bin/python3

# 40h == 64d
ansible_host6: "{{ home_net.vm.cidr6 | ipaddr('64') | ipaddr('address') }}"

provisioned_disks:
  - dev: "/dev/sdb"
    vols:
      - name: gitlab
        path: "/var/opt/gitlab"
        shrink: false
        size: "100%FREE"

node_exporter_web_listen_address: '0.0.0.0:9100'
node_exporter_port: "{{ node_exporter_web_listen_address.split(':')[1] }}"

gitlab_config_template: "{{ inventory_dir }}/files/gitlab/gitlab.rb.j2"

domain: "{{ hostvars['webgw01'].domains[4] }}"

gitlab_backup_keep_time: 604800  # 7 days
gitlab_backup_upload_remote_directory: "."
gitlab_backup_upload_connection:
  provider: "Local"
  local_root: "/mnt/backups"

gitlab_time_zone: "Europe/Oslo"

gitlab_external_url: "https://gitlab.{{ domain }}"

gitlab_redirect_http_to_https: "false"
gitlab_create_self_signed_cert: "false"
gitlab_nginx_listen_https: "false"
gitlab_nginx_listen_port: 80
gitlab_nginx_ssl_verify_client: ""
gitlab_nginx_ssl_client_certificate: ""
gitlab_nginx_trusted_addresses: "{{ proxy_hosts }}"

gitlab_registry_enable: "true"
gitlab_registry_port: 5005
gitlab_registry_external_url: "https://registry.{{ domain }}"
gitlab_registry_nginx_trusted_addresses: "{{ proxy_hosts }}"
gitlab_registry_nginx_listen_https: 'false'
gitlab_registry_nginx_listen_port: 5000

gitlab_email_enabled: "true"
gitlab_email_from: "gitlab@{{ domain }}"
gitlab_email_display_name: "Gitlab"
gitlab_email_reply_to: "no-reply@{{ domain }}"

gitlab_smtp_enable: "true"
gitlab_smtp_address: "{{ smtp_config[domain].host }}"
gitlab_smtp_port: "{{ smtp_config[domain].port }}"
gitlab_smtp_user_name: "{{ smtp_config[domain].user }}"
gitlab_smtp_password: "{{ smtp_config[domain].pass }}"
gitlab_smtp_domain: "{{ domain }}"
gitlab_smtp_authentication: "login"
gitlab_smtp_tls: "true"

gitlab_letsencrypt_enable: "false"
gitlab_ldap_enabled: "false"

gitlab_gc_oncalendar: "Tue,Fri 02:00:00"
